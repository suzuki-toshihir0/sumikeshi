<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'none';
             script-src 'self';
             style-src 'self' 'unsafe-inline';
             img-src 'self' blob: data:;
             font-src 'self';
             worker-src 'self' blob:;
             connect-src 'self';" />
  <title>sumikeshi - PDF墨消しツール</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div id="app">
    <header id="toolbar">
      <div class="toolbar-group">
        <label class="file-select-btn" title="PDF を開く">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v12"/><path d="m17 8-5-5-5 5"/><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/></svg>
          <input type="file" id="file-input" accept=".pdf,application/pdf" />
        </label>
      </div>
      <div class="toolbar-separator mode-group" hidden></div>
      <div class="toolbar-group mode-group" hidden>
        <div class="mode-toggle">
          <button id="btn-text-mode" class="mode-btn active" title="テキスト選択モード"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 22h-1a4 4 0 0 1-4-4V6a4 4 0 0 1 4-4h1"/><path d="M7 22h1a4 4 0 0 0 4-4v-1"/><path d="M7 2h1a4 4 0 0 1 4 4v1"/></svg></button>
          <button id="btn-rect-mode" class="mode-btn" title="矩形選択モード"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 3a2 2 0 0 0-2 2"/><path d="M19 3a2 2 0 0 1 2 2"/><path d="M21 19a2 2 0 0 1-2 2"/><path d="M5 21a2 2 0 0 1-2-2"/><path d="M9 3h1"/><path d="M9 21h1"/><path d="M14 3h1"/><path d="M14 21h1"/><path d="M3 9v1"/><path d="M21 9v1"/><path d="M3 14v1"/><path d="M21 14v1"/></svg></button>
          <span class="mode-slider"></span>
        </div>
      </div>
      <div class="toolbar-group action-group" hidden>
        <button id="btn-clear" class="action-btn" title="選択範囲をクリア"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg></button>
        <span class="toolbar-separator"></span>
        <button id="btn-redact" class="action-btn primary" title="選択した範囲を墨消し"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m14.622 17.897-10.68-2.913"/><path d="M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z"/><path d="M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15"/></svg></button>
        <button id="btn-download" class="action-btn download" title="墨消し済みPDFをダウンロード" hidden><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 15V3"/><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><path d="m7 10 5 5 5-5"/></svg></button>
      </div>
    </header>

    <main id="viewer-container">
      <div id="drop-zone">
        <p>PDFファイルをドラッグ＆ドロップ、<br>または上の「PDF を開く」ボタンから選択</p>
      </div>
      <div id="page-wrapper" hidden>
        <div id="page-container">
          <canvas id="pdf-canvas"></canvas>
          <div id="text-layer"></div>
          <div id="overlay-layer"></div>
        </div>
      </div>
    </main>

    <footer id="page-nav" hidden>
      <button id="btn-prev" title="前のページ">&#9664; 前</button>
      <span id="page-info">1 / 1</span>
      <button id="btn-next" title="次のページ">次 &#9654;</button>
    </footer>
  </div>
  <script type="module" src="./main.ts"></script>
</body>
</html>
